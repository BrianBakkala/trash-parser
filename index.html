<script>

    //const textLines = ["SMTWTFSSMTWTFSSMTWTFS", "T2345612312", "78910111213456789103456789", "141516171819201112131415161710111213141516", "212223242526271819202122232417181920212223", "28293031252627282924252627282930", "31", "SMTWTFSSMTWTFSSMTWTFS", "12345612341", "789101112135678910112345678", "14151617181920121314151617189101112131415", "212223242526271920212223242516171819202122", "28293026T2829303123242526272829", "30", "SMTWTFSSMTWTFSSMTWTFS", "12", "3T561231T34567", "7891011121345678910891011121314", "141516171819201112131415161715161718192021", "212223242526271819202122232422232425262728", "28293031252627282930312930", "SMTWTFSSMTWTFSSMTWTFS", "12345121", "2", "34567", "67891011123456789891011121314", "131415161718191011121314151615161718192021", "2021222324252617181920212223222324T262728", "272929303124252627T2930293031"];
    const textLines = ["SMTWTFSSMTWTFSSMTWTFS", "T2345612312", "78910111213456789103456789", "141516171819201112131415161710111213141516", "212223242526271819202122232417181920212223", "28293031252627282924252627282930", "31", "SMTWTFSSMTWTFSSMTWTFS"];
    getMonths(textLines);

    function getMonths(linesArray)
    {
        const headerRowRegex = /^SMTW/g;

        const monthData = {};
        const monthsInRow = 3;

        let rowIndex = 0;
        let bigRowIndex = 0;
        let monthIndex = 0;

        for (let row of linesArray)
        {
            const isAHeaderRow = headerRowRegex.test(row);
            monthData[monthIndex] = monthData[monthIndex] ?? [];

            if (!isAHeaderRow)
            {
                const numberArray = getConsecutiveNumbers(row);

                for (let week of numberArray)
                {
                    console.log(week);
                }

            }
        }

    }



    function getConsecutiveNumbers(numString)
    {
        const oneDigitRegex = /^\d/g;
        const twoDigitRegex = /^\d\d/g;

        let outputArray = [];
        let arrayIndex = 0;

        let match = null;

        console.log(match);
        let failsafe = 100;
        while (numString.length > 0 && failsafe > 0)
        {
            const expectedNum = +(match) + 1;
            if (match == null)
            {
                match = getFirstNumber(numString);
            }
            else if (outputArray[arrayIndex]?.length == 7)
            {
                arrayIndex++;
                match = getFirstNumber(numString);
            }
            else if (numString.startsWith("T"))
            {
                match = "T";
            }
            else if (numString.startsWith("" + expectedNum))
            {
                match = ("" + expectedNum);
            }
            else
            {
                if (outputArray[arrayIndex] && outputArray[arrayIndex].length > 0 && match != "T")
                {
                    arrayIndex++;
                    match = getFirstNumber(numString);
                }
                else if (twoDigitRegex.test(numString))
                {
                    if (+numString.match(twoDigitRegex)[0] <= 31 && +numString.match(twoDigitRegex)[0] >= 1)
                    {
                        match = Math.min(+numString.match(oneDigitRegex)[0], +numString.match(twoDigitRegex)[0]) + "";
                    }
                    else
                    {
                        match = numString.match(oneDigitRegex)[0];
                    }
                }
                else if (oneDigitRegex.test(numString))
                {
                    match = numString.match(oneDigitRegex)[0];
                }
            }

            outputArray[arrayIndex] = outputArray[arrayIndex] ?? [];
            outputArray[arrayIndex].push(match);



            numString = numString.slice(match.length);

            failsafe--;
        }

        if (numString.length > 0)
        {
            console.error("Unable to parse string");
        }
        else
        {
            return outputArray;
        }
    }

    function getFirstNumber(numString)
    {
        if (numString.length < 4)
        {
            return numString.slice(0, 2);
        }
        for (let numDigits = 2; numDigits >= 1; numDigits -= 1)
        {
            if (numString[0] == "T")
            {
                return "T";
            }

            const firstNumber = numString.slice(0, numDigits);
            const secondNumber = numString.slice(numDigits, 2 * numDigits);

            if (Math.abs((+firstNumber) - (+secondNumber)) == 1)
            {
                return firstNumber;
            }
        }
        return numString[0];

    }


</script>